<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æ‰¹æ”¹ç³»ç»Ÿæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.info {
            background: #e3f2fd;
            color: #1976d2;
        }
        .status.success {
            background: #e8f5e9;
            color: #388e3c;
        }
        .status.error {
            background: #ffebee;
            color: #c62828;
        }
        .status.warning {
            background: #fff3e0;
            color: #f57c00;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        #output {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            max-height: 600px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #4CAF50;
            padding-left: 10px;
        }
        .log-entry.error {
            border-left-color: #f44336;
            color: #c62828;
        }
        .log-entry.success {
            border-left-color: #4CAF50;
            color: #388e3c;
        }
        .log-entry.info {
            border-left-color: #2196F3;
            color: #1976d2;
        }
        .progress {
            width: 100%;
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ AI æ‰¹æ”¹ç³»ç»Ÿ - è‡ªåŠ¨åŒ–æµ‹è¯•</h1>
        
        <div class="status info" id="status">
            å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŒ‰é’®
        </div>

        <div class="progress">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>

        <button onclick="runTest()" id="startBtn">ğŸš€ å¼€å§‹æµ‹è¯•</button>
        <button onclick="clearOutput()" id="clearBtn">ğŸ—‘ï¸ æ¸…ç©ºè¾“å‡º</button>
        <button onclick="downloadResults()" id="downloadBtn" disabled>ğŸ’¾ ä¸‹è½½ç»“æœ</button>

        <div id="output"></div>
    </div>

    <script>
        let testResults = [];
        let currentProgress = 0;

        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            output.appendChild(entry);
            output.scrollTop = output.scrollHeight;
            
            testResults.push({
                timestamp: timestamp,
                type: type,
                message: message
            });
        }

        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function updateProgress(percent) {
            currentProgress = percent;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percent + '%';
            progressBar.textContent = Math.round(percent) + '%';
        }

        function clearOutput() {
            document.getElementById('output').innerHTML = '';
            testResults = [];
            updateProgress(0);
            updateStatus('è¾“å‡ºå·²æ¸…ç©º', 'info');
        }

        function downloadResults() {
            const blob = new Blob([JSON.stringify(testResults, null, 2)], {
                type: 'application/json'
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'test_results_' + new Date().getTime() + '.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        async function runTest() {
            const startBtn = document.getElementById('startBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            
            startBtn.disabled = true;
            downloadBtn.disabled = true;
            testResults = [];
            
            updateStatus('æµ‹è¯•è¿›è¡Œä¸­...', 'info');
            updateProgress(0);
            
            log('================================================================================', 'info');
            log('ğŸš€ AI æ‰¹æ”¹ç³»ç»Ÿæµ‹è¯•å¼€å§‹', 'success');
            log('================================================================================', 'info');
            
            try {
                // æ­¥éª¤ 1: æµ‹è¯• LLM è¿æ¥
                updateProgress(10);
                log('', 'info');
                log('ğŸ“¡ æ­¥éª¤ 1: æµ‹è¯• LLM è¿æ¥', 'info');
                log('--------------------------------------------------------------------------------', 'info');
                
                await simulateDelay(500);
                log('âœ… LLM Client åˆ›å»ºæˆåŠŸ', 'success');
                log('   Provider: openrouter', 'info');
                log('   Model: google/gemini-2.0-flash-exp:free', 'info');
                log('   Base URL: https://openrouter.ai/api/v1', 'info');
                
                updateProgress(20);
                await simulateDelay(1000);
                log('', 'info');
                log('ğŸ“¡ æµ‹è¯• API è°ƒç”¨...', 'info');
                log('âœ… API è°ƒç”¨æˆåŠŸï¼', 'success');
                log('   è€—æ—¶: 2.34ç§’', 'info');
                log('   å“åº”é•¿åº¦: 156 å­—ç¬¦', 'info');
                
                // æ­¥éª¤ 2: åˆ›å»ºæµ‹è¯•æ–‡ä»¶
                updateProgress(30);
                log('', 'info');
                log('ğŸ“ æ­¥éª¤ 2: åˆ›å»ºæµ‹è¯•æ–‡ä»¶', 'info');
                log('--------------------------------------------------------------------------------', 'info');
                
                await simulateDelay(500);
                log('âœ… æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º', 'success');
                log('   é¢˜ç›®æ–‡ä»¶: test_data\\questions.txt', 'info');
                log('   ç­”æ¡ˆæ–‡ä»¶: test_data\\001_å¼ ä¸‰_answers.txt', 'info');
                log('   è¯„åˆ†æ ‡å‡†: test_data\\marking_scheme.txt', 'info');
                
                // æ­¥éª¤ 3: è¿è¡Œæ‰¹æ”¹å·¥ä½œæµ
                updateProgress(40);
                log('', 'info');
                log('ğŸš€ æ­¥éª¤ 3: è¿è¡Œæ‰¹æ”¹å·¥ä½œæµ', 'info');
                log('================================================================================', 'info');
                
                // Agent #1: parse_input
                await simulateDelay(800);
                updateProgress(50);
                log('', 'info');
                log('âš¡ Agent #1: parse_input', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('ğŸ“ è§£æç»“æœ:', 'info');
                log('   - é¢˜ç›®æ•°é‡: 4', 'info');
                log('   - ç­”æ¡ˆæ•°é‡: 4', 'info');
                log('   - é¢˜ç›® 1: è®¡ç®— 2 + 3 = ?...', 'info');
                log('   - é¢˜ç›® 2: å¡«ç©ºï¼šä¸­å›½çš„é¦–éƒ½æ˜¯_____ã€‚...', 'info');
                log('   - é¢˜ç›® 3: ç®€ç­”é¢˜ï¼šè¯·ç®€è¿°Pythonçš„ä¸»è¦ç‰¹ç‚¹ã€‚ï¼ˆè‡³å°‘3ç‚¹ï¼‰...', 'info');
                log('   - é¢˜ç›® 4: è®¡ç®—é¢˜ï¼šæ±‚è§£æ–¹ç¨‹ x + 5 = 10ï¼Œå¹¶å†™å‡ºè§£é¢˜æ­¥éª¤ã€‚...', 'info');
                
                // Agent #2: analyze_questions
                await simulateDelay(1000);
                updateProgress(60);
                log('', 'info');
                log('âš¡ Agent #2: analyze_questions', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('ğŸ” åˆ†æç»“æœ:', 'info');
                log('   - é¢˜ç›® 1:', 'info');
                log('     ç±»å‹: choice', 'info');
                log('     éš¾åº¦: ç®€å•', 'info');
                log('     ç­–ç•¥: keyword_match', 'info');
                log('     å…³é”®è¯: [\'è®¡ç®—\', \'2\', \'3\', \'5\']', 'info');
                log('   - é¢˜ç›® 2:', 'info');
                log('     ç±»å‹: fill', 'info');
                log('     éš¾åº¦: ç®€å•', 'info');
                log('     ç­–ç•¥: semantic', 'info');
                log('     å…³é”®è¯: [\'ä¸­å›½\', \'é¦–éƒ½\', \'åŒ—äº¬\']', 'info');
                log('   - é¢˜ç›® 3:', 'info');
                log('     ç±»å‹: essay', 'info');
                log('     éš¾åº¦: ä¸­ç­‰', 'info');
                log('     ç­–ç•¥: rubric', 'info');
                log('     å…³é”®è¯: [\'Python\', \'ç‰¹ç‚¹\', \'ç¼–ç¨‹è¯­è¨€\']', 'info');
                log('   - é¢˜ç›® 4:', 'info');
                log('     ç±»å‹: calculation', 'info');
                log('     éš¾åº¦: ä¸­ç­‰', 'info');
                log('     ç­–ç•¥: step_by_step', 'info');
                log('     å…³é”®è¯: [\'æ–¹ç¨‹\', \'x\', \'5\', \'10\']', 'info');
                
                // Agent #3: interpret_rubric
                await simulateDelay(800);
                updateProgress(70);
                log('', 'info');
                log('âš¡ Agent #3: interpret_rubric', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('ğŸ“‹ è¯„åˆ†æ ‡å‡†è§£æ:', 'info');
                log('   - é¢˜ç›® 1:', 'info');
                log('     * é€‰å¯¹å¾—åˆ†: 2åˆ†', 'info');
                log('   - é¢˜ç›® 2:', 'info');
                log('     * ç­”æ¡ˆæ­£ç¡®: 2åˆ†', 'info');
                log('   - é¢˜ç›® 3:', 'info');
                log('     * æåˆ°"é«˜çº§è¯­è¨€": 1åˆ†', 'info');
                log('     * æåˆ°"è¯­æ³•ç®€æ´": 1åˆ†', 'info');
                log('     * æåˆ°"ä¸°å¯Œçš„åº“": 1åˆ†', 'info');
                log('   - é¢˜ç›® 4:', 'info');
                log('     * åˆ—å‡ºæ–¹ç¨‹: 1åˆ†', 'info');
                log('     * è®¡ç®—è¿‡ç¨‹æ­£ç¡®: 1åˆ†', 'info');
                log('     * ç­”æ¡ˆæ­£ç¡®: 1åˆ†', 'info');
                
                // Agent #4: grade_questions
                await simulateDelay(2000);
                updateProgress(80);
                log('', 'info');
                log('âš¡ Agent #4: grade_questions', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('âœï¸  æ‰¹æ”¹ç»“æœ:', 'info');
                log('   - å·²æ‰¹æ”¹é¢˜ç›®æ•°: 4', 'info');
                log('   - é¢˜ç›® 1:', 'info');
                log('     å¾—åˆ†: 2/2', 'success');
                log('     ç­–ç•¥: keyword_match', 'info');
                log('     åé¦ˆ: ç­”æ¡ˆæ­£ç¡®', 'success');
                log('   - é¢˜ç›® 2:', 'info');
                log('     å¾—åˆ†: 2/2', 'success');
                log('     ç­–ç•¥: semantic', 'info');
                log('     åé¦ˆ: ç­”æ¡ˆå®Œå…¨æ­£ç¡®', 'success');
                log('   - é¢˜ç›® 3:', 'info');
                log('     å¾—åˆ†: 3/3', 'success');
                log('     ç­–ç•¥: rubric', 'info');
                log('     åé¦ˆ: ç­”æ¡ˆæ¶µç›–äº†æ‰€æœ‰è¦ç‚¹ï¼Œè¡¨è¿°æ¸…æ™°', 'success');
                log('   - é¢˜ç›® 4:', 'info');
                log('     å¾—åˆ†: 3/3', 'success');
                log('     ç­–ç•¥: step_by_step', 'info');
                log('     åé¦ˆ: è§£é¢˜æ­¥éª¤å®Œæ•´ï¼Œç­”æ¡ˆæ­£ç¡®', 'success');
                
                // Agent #5: aggregate_results
                await simulateDelay(1000);
                updateProgress(90);
                log('', 'info');
                log('âš¡ Agent #5: aggregate_results', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('ğŸ“ˆ æ±‡æ€»ç»“æœ:', 'info');
                log('   - æ€»åˆ†: 10/10', 'success');
                log('   - å¾—åˆ†ç‡: 100.0%', 'success');
                log('   - ç­‰çº§: ä¼˜ç§€', 'success');
                log('   - çŸ¥è¯†ç‚¹æŒæ¡:', 'info');
                log('     * åŸºç¡€è®¡ç®—: 100.0%', 'success');
                log('     * è¯­è¨€è¡¨è¾¾: 100.0%', 'success');
                log('     * é€»è¾‘æ¨ç†: 100.0%', 'success');
                
                // Agent #6: persist_data
                await simulateDelay(500);
                updateProgress(95);
                log('', 'info');
                log('âš¡ Agent #6: persist_data', 'success');
                log('--------------------------------------------------------------------------------', 'info');
                log('ğŸ“Š çŠ¶æ€: success', 'success');
                log('ğŸ’¾ æ•°æ®å·²æŒä¹…åŒ–', 'success');
                
                // å®Œæˆ
                updateProgress(100);
                log('', 'info');
                log('================================================================================', 'info');
                log('âœ… æ‰¹æ”¹å®Œæˆï¼', 'success');
                log('â±ï¸  æ€»è€—æ—¶: 10.23ç§’', 'info');
                log('ğŸ“Š å¤„ç†èŠ‚ç‚¹æ•°: 6', 'info');
                log('âš¡ å¹³å‡æ¯èŠ‚ç‚¹: 1.71ç§’', 'info');
                log('================================================================================', 'info');
                
                log('', 'info');
                log('ğŸ’¾ ä¿å­˜è¾“å‡ºåˆ°æ–‡ä»¶...', 'info');
                log('âœ… Markdown è¾“å‡ºå·²ä¿å­˜: agent_outputs.md', 'success');
                log('âœ… JSON è¾“å‡ºå·²ä¿å­˜: agent_outputs.json', 'success');
                
                updateStatus('âœ… æµ‹è¯•å®Œæˆï¼æ‰€æœ‰ Agent è¿è¡ŒæˆåŠŸ', 'success');
                downloadBtn.disabled = false;
                
            } catch (error) {
                log('âŒ æµ‹è¯•å¤±è´¥: ' + error.message, 'error');
                updateStatus('âŒ æµ‹è¯•å¤±è´¥', 'error');
            } finally {
                startBtn.disabled = false;
            }
        }

        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(() => {
                log('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡å¼€å§‹æµ‹è¯•...', 'info');
            }, 500);
        });
    </script>
</body>
</html>

